-----------------------------------------------------------------------

require '/interface/newchat/colors.lua'

-----------------------------------------------------------------------

local MonsterID;
local MonsterPosition = {0, 0}

-----------------------------------------------------------------------

local function Clamp(value, min, max)

	return math.min(math.max(value, min), max)

end

local function Trim(s)

   return s:match '^%s*(.-)%s*$'

end

-----------------------------------------------------------------------

-- https://github.com/EmmanuelOga/columns/blob/master/utils/color.lua

--[[
 * Converts an RGB color value to HSL. Conversion formula
 * adapted from http://en.wikipedia.org/wiki/HSL_color_space.
 * Assumes r, g, and b are contained in the set [0, 255] and
 * returns h, s, and l in the set [0, 1].
 *
 * @param   Number  r       The red color value
 * @param   Number  g       The green color value
 * @param   Number  b       The blue color value
 * @return  Array           The HSL representation
]]
function rgbToHsl(r, g, b, a)
  r, g, b = r / 255, g / 255, b / 255

  local max, min = math.max(r, g, b), math.min(r, g, b)
  local h, s, l

  l = (max + min) / 2

  if max == min then
    h, s = 0, 0 -- achromatic
  else
    local d = max - min
    if l > 0.5 then s = d / (2 - max - min) else s = d / (max + min) end
    if max == r then
      h = (g - b) / d
      if g < b then h = h + 6 end
    elseif max == g then h = (b - r) / d + 2
    elseif max == b then h = (r - g) / d + 4
    end
    h = h / 6
  end

  return h, s, l, a or 255
end

--[[
 * Converts an HSL color value to RGB. Conversion formula
 * adapted from http://en.wikipedia.org/wiki/HSL_color_space.
 * Assumes h, s, and l are contained in the set [0, 1] and
 * returns r, g, and b in the set [0, 255].
 *
 * @param   Number  h       The hue
 * @param   Number  s       The saturation
 * @param   Number  l       The lightness
 * @return  Array           The RGB representation
]]
function hslToRgb(h, s, l, a)
  local r, g, b

  if s == 0 then
    r, g, b = l, l, l -- achromatic
  else
    function hue2rgb(p, q, t)
      if t < 0   then t = t + 1 end
      if t > 1   then t = t - 1 end
      if t < 1/6 then return p + (q - p) * 6 * t end
      if t < 1/2 then return q end
      if t < 2/3 then return p + (q - p) * (2/3 - t) * 6 end
      return p
    end

    local q
    if l < 0.5 then q = l * (1 + s) else q = l + s - l * s end
    local p = 2 * l - q

    r = hue2rgb(p, q, h + 1/3)
    g = hue2rgb(p, q, h)
    b = hue2rgb(p, q, h - 1/3)
  end

  return r * 255, g * 255, b * 255, a * 255
end

-----------------------------------------------------------------------

local DEFAULT_AVATAR = {}

local function GetAvatar(id)

	if type(id) == 'number' then

		local Portrait = world.entityPortrait(id, 'full')
		local Drawables = {}

		if Portrait then

			for i = 1, #Portrait do

				local Drawable = Portrait[i]

				if not (Drawable.image:find('^/.-/back%.png') or Drawable.image:find('^/.-/pants%.png:')) then

					if not Drawable.image:find('?blendmult=') then

						Drawable.image = Drawable.image .. '?addmask=/humanoid/portraitMask.png;0;0'

					end

					table.insert(Drawables, {

						image    = Drawable.image,
						position = Drawable.position

					})

				end

			end

		end

		return Drawables

	elseif type(id) == 'table' then

		for i = 1, #id do

			--Drawable.image, TextFormat.position

		end

		return id

	else

		return DEFAULT_AVATAR

	end

end

-----------------------------------------------------------------------

local TIMEZONE_OFFSET = 60 * 60 * -7
local WORLD_LENGTH    = 60 * 60 * 24
local FONT_SIZE = 8;

local Chat = {
		
	FONT_WIDTH = {[0]=0,454,0,454,454,454,454,454,454,454,454,454,454,255,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,255,278,328,610,587,756,672,165,359,361,464,559,250,397,297,382,587,587,587,587,587,587,587,587,587,587,289,268,521,586,529,509,916,689,653,670,665,576,561,697,723,298,572,650,554,897,723,707,660,707,653,629,633,674,669,895,650,633,620,284,432,284,447,457,338,549,576,534,577,553,367,584,573,271,266,547,271,886,573,579,576,578,373,526,346,573,517,752,521,514,521,338,259,338,664,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,255,289,589,608,709,549,258,643,478,803,454,511,564,397,803,513,397,550,381,381,339,630,501,308,274,381,468,511,735,779,827,509,689,689,689,689,689,689,962,670,576,576,576,576,298,298,298,298,680,723,707,707,707,707,707,544,705,674,674,674,674,633,623,646,549,549,549,549,549,549,864,534,553,553,553,553,280,280,280,280,589,573,579,579,579,579,579,584,578,573,573,573,573,514,581,514,689,549,689,549,689,549,670,534,670,534,670,534,670,534,665,652,680,645,576,553,576,553,576,553,576,553,576,553,697,584,697,584,697,584,697,584,723,573,737,588,298,280,298,280,298,280,298,271,298,280,870,537,572,288,650,547,604,554,271,554,271,554,346,554,381,571,313,723,573,723,573,723,573,573,720,578,707,579,707,579,707,579,991,923,653,373,653,373,653,373,629,526,629,526,629,526,629,526,633,346,633,366,633,346,674,573,674,573,674,573,674,573,674,573,674,573,895,752,633,514,633,620,521,620,521,620,521,265,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,711,454,454,369,454,454,454,454,454,454,454,454,454,454,454,454,454,718,595,454,454,454,454,454,454,454,454,454,454,454,454,454,729,624,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,288,454,454,454,454,454,454,454,454,454,689,549,962,864,705,578,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,629,526,633,346,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,288,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,542,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,117,454,454,454,454,454,454,454,454,454,507,482,454,513,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,271,341,308,492,420,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,321,454,454,454,454,454,454,454,454,454,454,454,454,0,0,454,0,454,454,454,454,454,0,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,345,561,689,308,576,723,298,454,717,454,683,698,345,689,653,570,748,576,620,723,704,298,650,663,897,723,580,707,724,660,454,580,633,633,788,650,744,688,298,633,577,569,578,345,559,577,616,522,578,569,513,578,604,345,604,561,630,517,542,579,659,578,527,586,533,559,763,521,762,840,345,559,579,559,840,454,454,609,605,454,454,454,847,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,576,576,765,570,675,629,298,298,572,1083,1084,790,650,717,646,717,689,641,653,570,765,576,1021,631,717,717,661,723,897,723,707,724,660,670,633,646,836,650,777,712,981,1045,789,892,640,666,966,611,549,583,579,429,646,553,874,526,581,581,577,582,777,581,579,581,576,534,521,514,748,521,624,567,847,921,671,847,571,532,831,572,553,553,573,429,532,526,271,280,266,879,882,578,577,581,514,581,969,840,640,571,914,772,676,572,957,817,892,751,1190,1030,526,515,744,762,704,578,658,522,658,522,1221,1093,704,578,969,827,969,840,636,547,637,0,0,0,0,0,0,0,796,668,640,571,644,577,568,472,570,429,637,541,1094,930,631,526,761,665,677,616,671,557,845,732,800,664,1008,723,1070,886,822,661,670,534,633,521,633,522,633,522,682,555,916,703,786,651,696,573,715,573,775,612,775,612,298,1021,874,665,584,800,668,724,578,802,666,712,567,973,849,298,689,549,689,549,962,864,576,553,711,542,711,542,1021,874,631,526,592,593,717,581,717,581,707,579,704,578,704,578,666,532,646,514,646,514,646,514,712,567,570,429,892,847,615,469,717,590,650,521,640,577,929,874,806,658,599,572,988,867,1018,845,648,542,722,652,671,569,832,700,512,384,0,454,0,454,454,454,454,454,454,454,454,454,454,252,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,252,275,323,596,575,738,657,165,353,355,455,547,247,390,293,376,575,575,575,575,575,575,575,575,575,575,285,265,510,573,518,499,894,673,639,655,650,563,549,681,707,294,560,635,543,875,706,691,645,691,639,615,619,659,654,873,636,619,607,281,424,281,439,448,333,537,564,523,564,542,361,572,561,268,263,535,268,865,561,566,564,566,367,515,340,561,507,735,510,503,510,333,256,333,649,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,252,285,576,595,692,537,255,629,468,784,446,501,552,397,784,502,390,538,375,375,334,616,491,304,271,375,459,501,718,761,807,499,689,689,689,689,689,689,938,670,576,576,576,576,298,298,298,298,665,723,707,707,707,707,707,532,689,674,674,674,674,633,609,631,549,549,549,549,549,549,843,534,553,553,553,553,280,280,280,280,576,573,579,579,579,579,579,571,565,573,573,573,573,514,568,514,689,549,689,549,673,537,670,534,670,534,670,534,670,534,665,639,665,631,576,553,576,553,576,553,563,542,576,553,697,584,697,584,697,584,697,584,723,573,720,576,298,280,298,280,298,280,298,271,298,277,854,531,572,288,650,547,591,554,271,554,271,554,343,554,378,559,308,723,573,723,573,723,573,573,703,565,707,579,707,579,707,579,967,901,653,373,653,373,653,373,629,526,629,526,629,526,629,526,633,346,633,360,619,340,674,573,674,573,674,573,674,573,674,573,659,561,895,752,633,514,633,620,521,620,521,620,521,262,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,695,454,454,363,454,454,454,454,454,454,454,454,454,454,454,454,454,701,582,454,454,454,454,454,454,454,454,454,454,454,454,454,712,611,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,288,454,454,454,454,454,454,454,454,454,689,549,962,864,705,578,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,629,526,633,346,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,285,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,530,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,117,454,454,454,454,454,454,454,454,454,497,472,454,513,454,454,454,454,454,454,454,454,454,454,454,454,454,454,446,268,336,304,482,412,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,317,454,454,454,454,454,454,454,454,454,454,454,454,0,0,454,0,454,454,454,454,454,0,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,339,549,689,308,576,723,298,454,701,454,669,682,345,689,653,558,731,576,620,723,688,298,650,648,897,723,568,707,708,660,454,568,633,633,769,650,726,672,298,633,577,569,578,345,559,564,602,512,565,557,502,565,591,339,604,549,630,517,531,579,644,565,516,573,522,547,745,510,744,820,345,559,579,559,840,454,454,596,592,454,454,454,826,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,576,576,747,570,660,615,298,298,572,1055,1056,771,650,717,646,700,689,627,653,570,747,576,996,617,700,717,646,706,897,723,707,724,660,670,633,632,816,650,758,695,957,1019,770,870,626,651,942,597,549,570,567,421,632,553,853,515,568,581,564,569,759,568,579,568,576,523,511,514,730,521,610,555,826,899,656,827,559,521,811,560,553,553,561,429,521,526,271,280,266,857,860,565,577,581,514,568,945,820,626,559,891,754,661,560,934,798,870,733,1160,1004,515,505,744,762,688,565,643,512,658,522,1194,1070,688,565,945,807,945,820,622,536,623,0,0,0,0,0,0,0,777,653,626,559,629,564,556,463,558,421,623,530,1066,907,631,526,743,650,662,603,656,546,825,715,781,649,983,706,1043,865,803,646,670,534,633,521,633,522,619,512,667,544,894,687,767,637,680,561,699,573,757,598,775,612,298,1021,874,650,572,781,653,707,565,783,651,712,567,949,829,298,689,549,689,549,962,864,576,553,695,542,711,542,1021,874,631,526,579,580,717,581,717,581,707,579,704,578,704,578,666,532,646,514,646,514,646,514,712,567,570,429,870,827,601,460,700,577,636,510,626,577,906,853,787,643,586,560,963,846,992,824,634,530,705,638,656,569,812,684,512,384,0,454,0,454,454,454,454,454,454,454,454,454,454,255,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,255,282,324,595,593,760,690,158,361,360,476,547,276,460,309,359,593,593,593,593,593,593,593,593,593,593,307,295,522,599,525,521,917,697,660,672,662,573,560,698,719,309,575,655,555,897,719,707,666,707,668,641,645,680,676,890,653,643,624,288,436,288,458,452,347,543,576,532,576,557,371,589,578,281,300,560,281,882,577,575,576,575,388,524,351,577,529,743,527,530,527,332,261,332,647,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,255,307,604,614,698,554,262,650,506,804,452,527,562,397,804,532,406,551,384,384,345,656,500,328,284,384,469,527,726,768,844,521,689,689,689,689,689,689,963,670,576,576,576,576,298,298,298,298,677,723,707,707,707,707,707,541,704,674,674,674,674,633,633,665,549,549,549,549,549,549,865,534,553,553,553,553,280,280,280,280,582,573,579,579,579,579,579,583,575,573,573,573,573,514,574,514,689,549,689,549,697,543,670,534,670,534,670,534,670,534,665,651,677,660,576,553,576,553,576,553,573,557,576,553,697,584,697,584,697,584,697,584,723,573,746,593,298,280,298,280,298,280,298,271,298,292,884,558,572,288,650,547,621,554,271,554,271,554,356,554,391,580,331,723,573,723,573,723,573,573,726,575,707,579,707,579,707,579,997,922,653,373,653,373,653,373,629,526,629,526,629,526,629,526,633,346,633,371,645,351,674,573,674,573,674,573,674,573,674,573,680,577,895,752,633,514,633,620,521,620,521,620,521,269,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,715,454,454,379,454,454,454,454,454,454,454,454,454,454,454,454,454,727,599,454,454,454,454,454,454,454,454,454,454,454,454,454,737,615,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,288,454,454,454,454,454,454,454,454,454,689,549,962,864,705,578,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,629,526,633,346,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,302,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,541,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,117,454,454,454,454,454,454,454,454,454,516,492,454,533,454,454,454,454,454,454,454,454,454,454,454,454,454,454,463,281,337,322,493,441,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,334,454,454,454,454,454,454,454,454,454,454,454,454,0,0,454,0,454,454,454,454,454,0,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,389,581,689,329,576,723,298,454,717,454,693,700,345,689,653,571,762,576,620,723,708,298,650,657,897,723,577,707,720,660,454,577,633,633,817,650,763,690,298,633,577,569,578,345,559,576,621,526,575,579,500,575,615,349,604,558,630,517,565,579,685,575,513,588,531,558,783,527,784,839,345,559,579,559,840,454,454,618,637,454,454,454,870,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,576,576,763,570,665,641,298,298,572,1074,1072,765,650,717,646,709,689,639,653,570,760,576,1068,644,709,717,662,722,897,723,707,724,660,670,633,647,857,650,790,715,989,1071,797,892,638,651,995,586,549,591,575,428,658,553,923,529,574,581,587,575,786,574,579,574,576,532,536,514,751,521,630,571,855,959,692,873,578,522,828,578,553,553,578,429,522,526,271,280,266,886,882,576,577,581,514,574,1008,874,638,578,911,776,708,585,988,840,898,746,1204,1040,523,528,744,762,708,575,663,526,658,522,1237,1105,708,575,1009,853,1008,874,618,546,635,0,0,0,0,454,0,0,804,682,638,578,638,574,572,480,571,428,642,555,1153,989,631,526,781,695,693,636,672,569,848,743,812,683,1017,720,1081,882,856,683,670,534,633,521,633,522,643,526,697,564,912,710,808,682,695,577,724,573,763,614,775,612,298,1021,874,674,597,812,682,720,575,810,681,712,567,987,872,298,689,549,689,549,962,864,576,553,715,542,711,542,1021,874,631,526,589,590,717,581,717,581,707,579,704,578,704,578,666,532,646,514,646,514,646,514,712,567,570,429,892,873,618,467,743,610,653,527,638,577,970,869,804,655,627,603,985,889,1013,842,655,550,719,650,659,569,861,731,454,454,0,512,0,512,512,512,512,512,512,512,512,512,512,252,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,512,252,279,320,582,580,742,674,158,355,354,466,535,272,451,305,353,580,580,580,580,580,580,580,580,580,580,303,291,511,586,514,511,894,681,645,657,647,561,548,682,703,304,563,640,543,875,702,691,651,691,653,627,631,665,661,868,639,628,611,285,428,285,449,443,342,532,564,521,563,546,365,576,565,278,273,548,278,860,565,563,564,563,381,514,346,565,518,726,516,519,516,327,258,327,633,512,512,344,344,344,344,344,344,512,335,288,288,288,288,149,149,149,149,512,361,353,353,353,353,353,512,512,337,337,337,337,316,512,252,303,591,601,682,542,259,636,496,785,443,516,550,397,785,521,399,539,377,377,340,642,490,323,281,377,460,516,709,750,824,511,689,689,689,689,689,689,939,670,576,576,576,576,298,298,298,298,662,723,707,707,707,707,707,530,688,674,674,674,674,633,619,650,549,549,549,549,549,549,844,534,553,553,553,553,280,280,280,280,570,573,579,579,579,579,579,570,563,573,573,573,573,514,562,514,689,549,689,549,681,532,670,534,670,534,670,534,670,534,665,638,662,645,576,553,576,553,576,553,561,546,576,553,697,584,697,584,697,584,697,584,723,573,728,580,298,280,298,280,298,280,298,271,298,288,867,551,572,288,650,547,607,554,271,554,271,554,353,554,388,567,326,723,573,723,573,723,573,573,709,563,707,579,707,579,707,579,972,900,653,373,653,373,653,373,629,526,629,526,629,526,629,526,633,346,633,366,631,346,674,573,674,573,674,573,674,573,674,573,665,565,895,752,633,514,633,620,521,620,521,620,521,266,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,698,454,454,372,454,454,454,454,454,454,454,454,454,454,454,454,454,710,586,454,454,454,454,454,454,454,454,454,454,454,454,454,720,602,144,454,454,454,454,454,454,454,454,454,344,274,481,432,352,289,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,314,263,316,173,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,288,454,454,454,454,454,454,454,512,454,689,549,962,864,705,578,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,629,526,633,346,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,298,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,530,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,117,454,454,454,454,454,454,454,454,454,512,512,454,512,454,454,454,454,454,454,454,454,454,454,454,454,454,454,512,512,512,512,512,512,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,512,454,454,454,454,454,454,454,117,454,454,454,454,512,512,454,512,454,506,482,454,522,512,454,454,454,454,454,512,454,454,454,454,454,454,454,454,278,332,318,483,433,454,454,454,454,454,454,512,454,454,454,454,454,454,454,454,454,454,454,454,454,454,329,454,454,454,454,454,454,454,454,454,454,454,454,0,0,454,0,454,454,454,454,454,0,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,512,512,344,512,288,361,149,454,512,454,512,512,172,344,326,512,512,288,310,361,512,149,325,512,448,361,512,353,512,330,454,512,316,316,512,325,512,512,149,316,288,284,289,172,279,512,512,512,512,512,512,512,512,512,302,512,315,258,512,289,512,512,512,383,569,689,324,576,723,298,172,701,289,678,685,345,689,653,559,744,576,620,723,692,298,650,643,897,723,564,707,704,660,454,564,633,633,797,650,745,675,298,633,577,569,578,345,559,563,608,515,563,567,490,563,602,343,604,546,630,517,553,579,670,563,503,575,520,546,765,516,766,819,345,559,579,559,840,323,512,604,623,326,285,512,849,512,512,512,358,512,512,448,361,353,362,330,335,316,512,512,325,512,512,512,512,512,512,512,512,512,512,274,512,512,512,512,276,512,512,512,290,512,512,512,512,289,576,576,745,570,650,627,298,298,572,1047,1045,747,650,717,646,693,689,625,653,570,742,576,1041,630,693,717,647,705,897,723,707,724,660,670,633,633,837,650,771,699,965,1044,778,870,624,636,970,573,549,579,563,420,643,553,901,518,562,581,574,563,767,562,579,562,576,521,525,514,733,521,616,559,835,935,676,852,566,511,808,565,553,553,565,429,511,526,271,280,266,864,860,563,577,581,514,562,983,853,624,566,889,758,692,573,963,820,876,729,1173,1014,513,517,744,762,692,563,648,515,658,522,1210,1082,692,563,983,833,983,853,604,534,621,0,0,0,0,512,0,0,785,667,624,566,624,562,560,471,559,420,628,543,1123,964,631,526,763,679,677,622,657,557,827,725,793,668,992,704,1053,861,836,668,670,534,633,521,633,522,628,515,681,552,889,694,789,666,679,565,708,573,745,601,775,612,298,1021,874,659,584,793,667,704,563,790,665,712,567,963,851,298,689,549,689,549,962,864,576,553,698,542,711,542,1021,874,631,526,577,578,717,581,717,581,707,579,704,578,704,578,666,532,646,514,646,514,646,514,712,567,570,429,870,852,605,458,726,597,639,516,624,577,946,848,785,641,613,590,961,867,988,822,641,538,703,635,644,569,840,714,454,454,0,454,0,454,454,454,454,454,454,454,454,454,454,255,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,255,274,332,625,582,752,654,173,357,361,452,570,225,336,286,405,582,582,582,582,582,582,582,582,582,582,271,243,520,573,533,498,916,681,646,668,669,579,562,697,727,289,568,645,554,896,727,707,654,707,639,618,621,667,662,901,648,624,616,280,428,280,437,462,330,554,576,536,578,549,363,580,568,261,256,534,261,891,569,583,576,581,360,528,340,569,506,761,515,498,515,343,257,343,680,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,255,271,574,602,718,544,254,636,450,802,456,497,566,397,802,493,389,549,379,379,333,605,502,289,264,379,467,497,744,789,811,498,689,689,689,689,689,689,962,670,576,576,576,576,298,298,298,298,684,723,707,707,707,707,707,546,706,674,674,674,674,633,613,627,549,549,549,549,549,549,864,534,553,553,553,553,280,280,280,280,595,573,579,579,579,579,579,584,580,573,573,573,573,514,587,514,689,549,689,549,681,554,670,534,670,534,670,534,670,534,665,653,684,630,576,553,576,553,576,553,579,549,576,553,697,584,697,584,697,584,697,584,723,573,728,583,298,280,298,280,298,280,298,271,298,269,857,518,572,288,650,547,588,554,271,554,271,554,336,554,371,562,295,723,573,723,573,723,573,573,713,580,707,579,707,579,707,579,986,925,653,373,653,373,653,373,629,526,629,526,629,526,629,526,633,346,633,360,621,340,674,573,674,573,674,573,674,573,674,573,667,569,895,752,633,514,633,620,521,620,521,620,521,262,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,708,454,454,360,454,454,454,454,454,454,454,454,454,454,454,454,454,709,591,454,454,454,454,454,454,454,454,454,454,454,454,454,722,633,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,288,454,454,454,454,454,454,454,454,454,689,549,962,864,705,578,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,629,526,633,346,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,275,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,542,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,117,454,454,454,454,454,454,454,454,454,499,472,454,494,454,454,454,454,454,454,454,454,454,454,454,454,454,454,446,261,345,294,492,399,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,310,454,454,454,454,454,454,454,454,454,454,454,454,0,0,454,0,454,454,454,454,454,0,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,302,542,689,308,576,723,298,454,717,454,674,695,345,689,653,570,735,576,620,723,701,298,650,668,897,723,584,707,728,660,454,584,633,633,759,650,725,685,298,633,577,569,578,345,559,578,611,519,580,560,525,580,592,341,604,565,630,517,521,579,633,580,539,584,534,560,744,515,740,842,345,559,579,559,840,454,454,601,573,454,454,454,824,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,576,576,767,570,684,618,298,298,572,1092,1095,813,650,717,646,725,689,644,653,570,771,576,977,619,724,717,660,724,897,723,707,724,660,670,633,645,815,650,764,708,973,1020,781,892,643,680,938,635,549,574,583,429,635,553,827,523,588,581,567,589,769,587,579,588,576,536,506,514,745,521,617,563,839,886,651,823,564,542,834,568,553,553,568,429,542,526,271,280,266,872,882,580,577,581,514,588,932,807,643,563,916,768,646,560,929,795,886,755,1177,1020,528,504,744,762,701,580,653,519,658,522,1205,1081,701,580,930,802,932,807,653,549,639,0,0,0,0,454,0,0,789,653,643,563,649,579,565,464,570,429,633,528,1038,873,631,526,742,637,662,597,670,546,842,722,788,646,1000,725,1059,890,789,639,670,534,633,521,633,522,624,519,668,547,920,696,765,622,698,569,707,573,786,609,775,612,298,1021,874,656,572,788,654,727,580,794,653,712,567,959,828,298,689,549,689,549,962,864,576,553,708,542,711,542,1021,874,631,526,595,595,717,581,717,581,707,579,704,578,704,578,666,532,646,514,646,514,646,514,712,567,570,429,892,823,611,471,691,570,648,515,643,577,888,878,809,660,573,543,991,846,1022,847,642,534,725,654,682,569,804,671,454,454,0,454,0,454,454,454,454,454,454,454,454,454,454,252,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,252,271,327,611,569,734,640,173,351,355,444,558,223,331,282,398,569,569,569,569,569,569,569,569,569,569,268,241,510,561,522,488,893,666,631,653,654,566,550,681,710,285,556,631,542,874,710,691,640,691,625,604,608,652,647,879,633,610,603,277,420,277,429,453,325,542,564,525,565,538,357,568,556,258,254,523,258,869,557,570,564,569,354,517,335,557,496,743,504,488,504,338,254,338,665,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,252,268,562,589,702,532,251,622,442,783,448,487,554,397,783,483,382,537,372,372,328,592,492,285,261,372,458,487,726,771,792,488,689,689,689,689,689,689,938,670,576,576,576,576,298,298,298,298,669,723,707,707,707,707,707,534,690,674,674,674,674,633,599,613,549,549,549,549,549,549,843,534,553,553,553,553,280,280,280,280,582,573,579,579,579,579,579,572,567,573,573,573,573,514,575,514,689,549,689,549,666,542,670,534,670,534,670,534,670,534,665,640,669,616,576,553,576,553,576,553,566,538,576,553,697,584,697,584,697,584,697,584,723,573,711,571,298,280,298,280,298,280,298,271,298,266,842,512,572,288,650,547,575,554,271,554,271,554,333,554,368,550,291,723,573,723,573,723,573,573,697,567,707,579,707,579,707,579,961,902,653,373,653,373,653,373,629,526,629,526,629,526,629,526,633,346,633,355,608,335,674,573,674,573,674,573,674,573,674,573,652,557,895,752,633,514,633,620,521,620,521,620,521,259,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,692,454,454,354,454,454,454,454,454,454,454,454,454,454,454,454,454,692,578,454,454,454,454,454,454,454,454,454,454,454,454,454,705,619,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,288,454,454,454,454,454,454,454,454,454,689,549,962,864,705,578,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,629,526,633,346,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,272,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,530,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,117,454,454,454,454,454,454,454,454,454,489,463,454,484,454,454,454,454,454,454,454,454,454,454,454,454,454,454,437,258,339,290,482,392,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,305,454,454,454,454,454,454,454,454,454,454,454,454,0,0,454,0,454,454,454,454,454,0,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,298,530,689,308,576,723,298,454,701,454,660,680,345,689,653,558,718,576,620,723,685,298,650,653,897,723,571,707,711,660,454,571,633,633,741,650,708,670,298,633,577,569,578,345,559,565,597,508,567,548,514,567,579,336,604,553,630,517,511,579,619,567,528,571,523,548,726,504,723,821,345,559,579,559,840,454,454,588,561,454,454,454,805,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,576,576,749,570,669,604,298,298,572,1064,1067,794,650,717,646,708,689,629,653,570,753,576,952,605,707,717,645,708,897,723,707,724,660,670,633,630,796,650,746,692,949,995,762,870,629,664,915,621,549,562,571,421,621,553,807,512,575,581,555,576,751,575,579,575,576,525,496,514,728,521,604,551,819,864,637,804,552,530,814,556,553,553,556,429,530,526,271,280,266,851,860,568,577,581,514,575,909,788,629,551,893,750,631,548,906,776,865,737,1146,995,517,494,744,762,685,567,638,508,658,522,1179,1059,685,567,907,783,909,788,638,537,625,0,0,0,0,454,0,0,770,639,629,551,635,566,553,455,558,421,619,517,1012,852,631,526,724,623,647,584,655,535,822,705,769,632,975,708,1032,869,770,625,670,534,633,521,633,522,610,508,653,535,898,680,747,608,682,557,691,573,767,596,775,612,298,1021,874,642,560,769,640,710,567,775,638,712,567,935,808,298,689,549,689,549,962,864,576,553,692,542,711,542,1021,874,631,526,582,582,717,581,717,581,707,579,704,578,704,578,666,532,646,514,646,514,646,514,712,567,570,429,870,804,598,462,676,558,633,504,629,577,867,857,790,645,561,531,966,826,997,826,627,523,708,640,667,569,785,656,895,752,0,454,0,454,454,454,454,454,454,454,454,454,454,253,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,253,263,327,630,575,750,636,178,350,356,441,580,201,282,269,422,575,575,575,575,575,575,575,575,575,575,248,216,520,562,535,483,919,668,637,666,671,582,566,697,730,278,565,642,551,894,730,704,646,704,630,607,611,664,651,908,642,615,613,271,420,271,428,462,316,557,574,536,577,542,355,574,564,248,244,519,248,897,565,584,574,582,346,528,334,564,496,769,507,484,507,346,249,346,696,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,253,249,560,595,730,537,245,628,428,804,457,480,567,397,805,469,382,547,375,375,321,580,500,267,253,375,465,480,750,794,796,484,689,689,689,689,689,689,957,670,576,576,576,576,298,298,298,298,686,723,707,707,707,707,707,546,704,674,674,674,674,633,605,609,549,549,549,549,549,549,864,534,553,553,553,553,280,280,280,280,600,573,579,579,579,579,579,584,580,573,573,573,573,514,590,514,689,549,689,549,668,557,670,534,670,534,670,534,670,534,665,652,686,611,576,553,576,553,576,553,582,542,576,553,697,584,697,584,697,584,697,584,723,573,717,579,298,280,298,280,298,280,298,271,298,253,843,493,572,288,650,547,569,554,271,554,271,554,323,554,358,551,276,723,573,723,573,723,573,573,709,580,707,579,707,579,707,579,976,930,653,373,653,373,653,373,629,526,629,526,629,526,629,526,633,346,633,354,611,334,674,573,674,573,674,573,674,573,674,573,664,564,895,752,633,514,633,620,521,620,521,620,521,254,174,130,87,287,140,104,52,0,454,454,454,454,198,198,454,707,390,390,348,228,119,117,127,107,207,209,206,454,275,296,184,454,703,585,378,131,454,454,454,454,454,454,454,454,491,454,165,712,633,454,454,454,454,159,154,454,278,454,454,454,454,454,454,454,228,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,288,454,454,454,454,454,454,454,454,454,689,549,962,864,705,578,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,629,526,633,346,454,454,454,561,304,454,416,440,555,413,444,296,293,454,454,454,454,383,454,454,454,454,454,454,454,270,304,257,349,361,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,539,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,376,454,454,454,454,454,454,454,454,454,454,454,454,454,252,454,454,519,454,454,454,454,454,454,454,454,454,454,454,323,454,454,454,344,454,454,454,454,454,454,454,324,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,117,454,454,454,454,454,454,454,454,454,482,454,454,469,454,454,454,454,454,454,454,454,454,454,454,454,454,401,437,248,342,277,483,382,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,301,454,454,454,454,454,454,454,454,454,454,454,454,0,0,454,0,454,454,454,454,454,0,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,293,454,454,454,374,454,262,517,689,267,576,723,298,354,714,321,665,691,345,689,653,569,722,576,620,723,696,298,650,671,897,723,584,707,730,660,454,584,633,633,733,650,708,681,298,633,577,569,578,345,559,578,606,513,580,552,530,580,583,331,604,567,630,517,502,579,610,580,550,580,534,558,721,507,717,843,345,559,579,559,840,454,454,592,545,454,454,454,804,454,454,454,454,454,293,454,454,454,260,264,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,576,576,767,570,690,607,298,298,572,1096,1106,833,650,717,646,730,689,645,653,570,770,576,929,607,730,717,658,724,897,723,707,724,660,670,633,643,790,650,748,701,963,992,777,885,642,690,915,652,549,566,585,429,618,553,784,520,591,581,553,592,759,590,579,591,576,536,492,514,742,521,606,556,828,847,635,795,556,550,835,562,553,553,564,429,550,526,271,280,266,868,882,580,577,581,514,591,900,789,642,555,917,764,617,547,901,773,872,752,1154,1000,529,493,744,762,696,581,645,513,658,522,1188,1068,696,580,896,786,900,789,665,547,638,0,0,0,0,454,0,0,772,630,642,555,653,580,561,456,569,429,621,514,977,816,631,526,717,604,644,575,668,531,838,705,767,620,999,730,1048,890,759,617,670,534,633,521,633,522,615,513,652,533,918,686,734,587,695,565,695,573,791,606,775,612,298,1021,874,644,557,767,631,729,580,777,630,712,567,935,799,298,689,549,689,549,962,864,576,553,707,542,711,542,1021,874,631,526,596,596,717,581,717,581,707,579,704,578,704,578,666,532,646,514,646,514,646,514,712,567,570,429,885,795,603,469,663,544,642,507,635,577,842,882,811,661,548,515,992,826,1021,848,635,526,726,656,690,569,769,633,454,454,0,454,0,454,454,454,454,454,454,454,454,454,454,251,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,251,260,322,616,563,732,622,178,344,350,433,568,200,279,266,414,563,563,563,563,563,563,563,563,563,563,245,215,510,550,524,474,897,653,623,651,656,569,554,681,713,275,553,627,539,872,713,688,631,688,616,594,597,649,637,886,627,601,599,268,412,268,420,453,312,545,562,525,565,531,350,562,552,246,242,508,246,875,553,571,562,569,341,517,329,552,486,751,497,475,497,341,247,341,680,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,251,247,548,582,713,526,243,614,420,785,449,471,555,397,786,460,376,535,369,369,316,567,490,264,251,369,456,470,732,775,777,475,689,689,689,689,689,689,933,670,576,576,576,576,298,298,298,298,671,723,707,707,707,707,707,534,688,674,674,674,674,633,592,595,549,549,549,549,549,549,843,534,553,553,553,553,280,280,280,280,587,573,579,579,579,579,579,572,567,573,573,573,573,514,577,514,689,549,689,549,653,545,670,534,670,534,670,534,670,534,665,640,671,598,576,553,576,553,576,553,569,531,576,553,697,584,697,584,697,584,697,584,723,573,700,567,298,280,298,280,298,280,298,271,298,250,828,488,572,288,650,547,557,554,271,554,271,554,321,554,356,540,273,723,573,723,573,723,573,573,693,567,707,579,707,579,707,579,952,907,653,373,653,373,653,373,629,526,629,526,629,526,629,526,633,346,633,349,597,329,674,573,674,573,674,573,674,573,674,573,649,552,895,752,633,514,633,620,521,620,521,620,521,251,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,691,454,454,343,454,454,454,454,454,454,454,454,454,454,454,454,454,687,572,454,454,454,454,454,454,454,454,454,454,454,454,454,695,619,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,288,454,454,454,454,454,454,454,454,454,689,549,962,864,705,578,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,629,526,633,346,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,260,454,454,454,454,454,454,255,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,528,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,117,454,454,454,454,454,454,454,454,454,472,446,454,460,454,454,454,454,454,454,454,454,454,454,454,454,454,454,429,246,337,273,473,375,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,297,454,454,454,454,454,454,454,454,454,454,454,454,0,0,454,0,454,454,454,454,454,0,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,259,507,689,264,576,723,298,454,698,454,651,675,345,689,653,557,705,576,620,723,680,298,650,656,897,723,572,707,713,660,454,572,633,633,716,650,692,665,298,633,577,569,578,345,559,566,593,502,567,540,519,567,570,326,604,555,630,517,492,579,596,567,539,567,523,546,705,497,700,823,345,559,579,559,840,454,454,579,533,454,454,454,785,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,576,576,749,570,674,594,298,298,572,1068,1078,813,650,717,646,713,689,631,653,570,752,576,906,594,713,717,643,708,897,723,707,724,660,670,633,629,771,650,731,685,939,967,758,864,628,674,893,637,549,554,572,421,604,553,765,509,578,581,541,579,741,578,579,578,576,525,482,514,725,521,593,545,808,826,621,776,544,539,815,550,553,553,552,429,539,526,271,280,266,847,860,568,577,581,514,578,878,771,628,543,895,746,603,535,879,755,851,735,1124,975,518,483,744,762,680,569,630,503,658,522,1163,1046,680,567,874,767,878,771,650,536,624,0,0,0,0,454,0,0,754,616,628,543,639,568,549,447,557,421,608,504,952,797,631,526,700,591,630,563,653,521,818,689,749,607,974,713,1022,868,741,604,670,534,633,521,633,522,601,502,637,522,895,670,717,574,679,553,679,573,773,593,775,612,298,1021,874,630,545,749,617,712,567,758,616,712,567,912,780,298,689,549,689,549,962,864,576,553,691,542,711,542,1021,874,631,526,583,583,717,581,717,581,707,579,704,578,704,578,666,532,646,514,646,514,646,514,712,567,570,429,864,776,590,460,648,532,627,497,621,577,821,860,791,646,537,505,967,806,996,828,621,515,709,641,674,569,751,619,454,454,0,454,0,454,454,454,454,454,454,454,454,454,454,249,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,249,231,294,595,567,756,630,174,326,333,434,578,196,293,244,406,567,567,567,567,567,567,567,567,567,567,215,199,523,566,530,465,935,639,627,665,670,582,576,700,724,272,563,646,539,886,727,693,630,693,650,606,611,673,631,918,626,613,612,245,403,245,426,442,292,548,567,527,569,529,339,568,562,229,233,501,229,907,562,573,567,571,344,518,329,562,492,772,498,486,498,338,226,338,701,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,249,226,557,585,740,528,222,619,440,818,453,466,558,397,821,437,387,542,370,370,288,570,486,251,249,370,461,464,742,774,795,470,689,689,689,689,689,689,932,670,576,576,576,576,298,298,298,298,685,723,707,707,707,707,707,536,693,674,674,674,674,633,607,600,549,549,549,549,549,549,866,534,553,553,553,553,280,280,280,280,595,573,579,579,579,579,579,582,570,573,573,573,573,514,575,514,689,549,689,549,639,548,670,534,670,534,670,534,670,534,665,644,685,586,576,553,576,553,576,553,582,529,576,553,697,584,697,584,697,584,697,584,723,573,705,577,298,280,298,280,298,280,298,271,298,228,836,463,572,288,650,547,555,554,271,554,271,554,304,554,339,541,264,723,573,723,573,723,573,573,717,570,707,579,707,579,707,579,956,946,653,373,653,373,653,373,629,526,629,526,629,526,629,526,633,346,633,349,611,329,674,573,674,573,674,573,674,573,674,573,673,562,895,752,633,514,633,620,521,620,521,620,521,232,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,716,454,454,335,454,454,454,454,454,454,454,454,454,454,454,454,454,714,573,454,454,454,454,454,454,454,454,454,454,454,454,454,697,600,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,288,454,454,454,454,454,454,454,454,454,689,549,962,864,705,578,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,629,526,633,346,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,234,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,527,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,117,454,454,454,454,454,454,454,454,454,440,418,454,437,454,454,454,454,454,454,454,454,454,454,454,454,454,454,432,229,317,256,445,386,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,311,454,454,454,454,454,454,454,454,454,454,454,454,0,0,454,0,454,454,454,454,454,0,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,259,490,689,308,576,723,298,454,703,454,663,680,345,689,653,565,713,576,620,723,689,298,650,663,897,723,572,707,724,660,454,572,633,633,732,650,711,670,298,633,577,569,578,345,559,576,606,501,570,556,503,570,586,307,604,563,630,517,502,579,609,570,547,569,523,547,702,498,700,844,345,559,579,559,840,454,454,587,549,454,454,454,805,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,576,576,762,570,676,606,298,298,572,1080,1105,823,650,717,646,722,689,642,653,570,741,576,901,609,727,717,654,719,897,723,707,724,660,670,633,642,760,650,730,681,948,965,792,855,627,676,932,626,549,563,572,431,587,553,785,518,575,581,530,576,748,575,579,575,576,527,486,514,742,521,583,545,812,821,645,769,548,547,832,556,553,553,562,429,547,526,271,280,266,875,882,570,577,581,514,575,909,843,627,547,915,761,614,540,899,771,834,723,1106,949,527,495,744,762,689,579,630,504,658,522,1179,1060,689,570,904,817,909,843,648,535,624,0,0,0,0,454,0,0,729,585,627,547,647,578,561,448,565,431,591,509,937,794,631,526,684,573,628,553,664,513,827,675,724,580,1031,741,1044,872,761,608,670,534,633,521,633,522,613,501,635,505,889,669,680,550,679,563,679,573,773,604,775,612,298,1021,874,628,540,722,586,721,570,728,585,712,567,887,759,298,689,549,689,549,962,864,576,553,716,542,711,542,1021,874,631,526,589,589,717,581,717,581,707,579,704,578,704,578,666,532,646,514,646,514,646,514,712,567,570,429,855,769,582,451,641,511,626,498,586,577,799,879,808,659,546,513,990,824,997,846,632,524,724,653,676,569,723,587,454,454,0,454,0,454,454,454,454,454,454,454,454,454,454,246,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,246,229,290,582,555,739,616,174,321,328,426,565,195,289,242,399,555,555,555,555,555,555,555,555,555,555,213,198,513,554,519,456,912,625,613,650,655,570,563,684,708,269,551,631,528,864,710,677,616,677,635,593,598,658,617,895,612,599,599,243,396,243,418,433,288,537,555,516,557,518,334,556,550,227,231,491,227,885,550,561,555,559,339,508,324,550,482,754,488,477,488,333,224,333,685,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,246,224,546,572,723,517,220,606,432,799,444,457,546,397,801,429,380,531,364,364,284,558,477,249,246,364,452,455,724,756,776,461,689,689,689,689,689,689,909,670,576,576,576,576,298,298,298,298,670,723,707,707,707,707,707,525,677,674,674,674,674,633,594,587,549,549,549,549,549,549,845,534,553,553,553,553,280,280,280,280,582,573,579,579,579,579,579,569,558,573,573,573,573,514,563,514,689,549,689,549,625,537,670,534,670,534,670,534,670,534,665,632,670,573,576,553,576,553,576,553,570,518,576,553,697,584,697,584,697,584,697,584,723,573,689,565,298,280,298,280,298,280,298,271,298,226,821,459,572,288,650,547,544,554,271,554,271,554,302,554,337,530,261,723,573,723,573,723,573,573,700,558,707,579,707,579,707,579,933,922,653,373,653,373,653,373,629,526,629,526,629,526,629,526,633,346,633,344,598,324,674,573,674,573,674,573,674,573,674,573,658,550,895,752,633,514,633,620,521,620,521,620,521,230,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,700,454,454,330,454,454,454,454,454,454,454,454,454,454,454,454,454,697,561,454,454,454,454,454,454,454,454,454,454,454,454,454,681,587,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,288,454,454,454,454,454,454,454,454,454,689,549,962,864,705,578,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,629,526,633,346,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,232,454,454,256,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,516,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,117,454,454,454,454,454,454,454,454,454,432,410,454,429,454,454,454,454,454,454,454,454,454,454,454,454,454,454,424,227,313,253,437,380,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,306,454,454,454,454,454,454,454,454,454,454,454,454,0,0,454,0,454,454,454,454,454,0,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,256,481,689,308,576,723,298,454,687,454,649,665,345,689,653,553,697,576,620,723,673,298,650,648,897,723,560,707,708,660,454,560,633,633,715,650,694,655,298,633,577,569,578,345,559,564,593,491,558,545,493,558,574,303,604,551,630,517,492,579,596,558,536,557,513,536,686,488,684,823,345,559,579,559,840,454,454,575,537,454,454,454,786,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,576,576,744,570,660,593,298,298,572,1053,1077,804,650,717,646,705,689,628,653,570,724,576,879,595,710,717,639,702,897,723,707,724,660,670,633,628,742,650,713,666,924,941,773,834,613,660,909,612,549,551,560,423,574,553,767,508,563,581,519,564,731,563,579,563,576,516,477,514,724,521,570,533,793,802,630,751,536,536,812,544,553,553,550,429,536,526,271,280,266,854,860,558,577,581,514,563,886,822,613,536,892,743,601,529,877,753,814,707,1078,925,516,485,744,762,673,566,616,494,658,522,1154,1038,673,558,882,798,886,822,633,524,611,0,0,0,0,454,0,0,712,573,613,536,632,565,549,439,553,423,578,499,914,775,631,526,669,561,614,541,649,503,807,660,707,568,1005,724,1017,851,743,595,670,534,633,521,633,522,599,491,621,495,867,654,665,538,663,551,663,573,755,591,775,612,298,1021,874,614,529,706,573,705,558,711,572,712,567,866,741,298,689,549,689,549,962,864,576,553,700,542,711,542,1021,874,631,526,577,577,717,581,717,581,707,579,704,578,704,578,666,532,646,514,646,514,646,514,712,567,570,429,834,751,570,443,627,500,612,488,574,577,780,858,789,644,534,502,965,804,972,825,618,513,707,639,660,569,707,574,454,454,0,454,0,454,454,454,454,454,454,454,454,454,454,245,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,245,198,260,560,560,763,623,170,303,311,428,575,191,303,219,391,560,560,560,560,560,560,560,560,560,560,182,182,526,571,526,446,951,611,617,663,670,583,586,703,719,267,562,650,528,878,724,682,615,682,670,605,612,682,611,927,611,611,612,219,387,219,424,422,268,540,560,519,560,516,322,561,560,211,222,484,211,918,560,563,560,560,342,509,324,560,489,775,489,489,489,330,203,330,706,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,245,203,555,575,751,519,199,611,453,833,449,452,550,397,837,405,391,538,364,364,255,560,473,236,245,364,457,448,733,754,793,456,689,689,689,689,689,689,908,670,576,576,576,576,298,298,298,298,685,723,707,707,707,707,707,526,682,674,674,674,674,633,609,591,549,549,549,549,549,549,867,534,553,553,553,553,280,280,280,280,591,573,579,579,579,579,579,579,560,573,573,573,573,514,560,514,689,549,689,549,611,540,670,534,670,534,670,534,670,534,665,635,685,560,576,553,576,553,576,553,583,516,576,553,697,584,697,584,697,584,697,584,723,573,694,575,298,280,298,280,298,280,298,271,298,203,829,433,572,288,650,547,542,554,271,554,271,554,286,554,321,530,252,723,573,723,573,723,573,573,725,560,707,579,707,579,707,579,936,962,653,373,653,373,653,373,629,526,629,526,629,526,629,526,633,346,633,344,612,324,674,573,674,573,674,573,674,573,674,573,682,560,895,752,633,514,633,620,521,620,521,620,521,211,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,726,454,454,322,454,454,454,454,454,454,454,454,454,454,454,454,454,725,561,454,454,454,454,454,454,454,454,454,454,454,454,454,682,566,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,288,454,454,454,454,454,454,454,454,454,689,549,962,864,705,578,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,629,526,633,346,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,211,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,516,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,117,454,454,454,454,454,454,454,454,454,398,382,454,513,454,454,454,454,454,454,454,454,454,454,454,454,454,454,428,211,293,235,408,391,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,321,454,454,454,454,454,454,454,454,454,454,454,454,0,0,454,0,454,454,454,454,454,0,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,257,464,689,308,576,723,298,454,692,454,661,670,345,689,653,561,705,576,620,723,682,298,650,656,897,723,560,707,719,660,454,560,633,633,731,650,714,660,298,633,577,569,578,345,559,574,606,489,560,561,477,560,590,282,604,560,630,517,503,579,609,560,544,558,513,536,682,489,683,845,345,559,579,559,840,454,454,582,553,454,454,454,806,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,576,576,756,570,662,605,298,298,572,1064,1104,814,650,717,646,714,689,640,653,570,712,576,872,610,724,717,650,714,897,723,707,724,660,670,633,641,731,650,713,662,933,938,808,824,611,662,948,600,549,561,560,433,556,553,787,517,560,581,508,561,738,560,579,560,576,519,481,514,742,521,560,533,797,796,654,743,540,544,829,550,553,553,560,429,544,526,271,280,266,882,882,560,577,581,514,560,918,897,611,540,912,759,612,533,896,768,796,694,1059,898,524,498,744,762,682,576,616,495,658,522,1171,1052,682,560,912,849,918,897,631,524,610,0,0,0,0,454,0,0,686,540,611,540,640,575,561,440,561,433,560,504,896,772,631,526,652,541,611,531,660,494,816,645,681,540,1064,752,1039,854,763,599,670,534,633,521,633,522,611,489,619,478,860,652,626,513,662,561,662,573,754,601,775,612,298,1021,874,611,523,678,540,714,560,680,540,712,567,839,718,298,689,549,689,549,962,864,576,553,726,542,711,542,1021,874,631,526,583,583,717,581,717,581,707,579,704,578,704,578,666,532,646,514,646,514,646,514,712,567,570,429,824,743,570,429,619,478,611,489,538,577,757,877,806,656,543,510,987,821,973,843,630,521,721,651,662,569,678,541,454,454,0,454,0,454,454,454,454,454,454,454,454,454,454,242,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,242,197,257,548,548,745,610,170,299,307,420,563,191,299,218,384,548,548,548,548,548,548,548,548,548,548,181,181,515,559,515,438,927,598,604,648,655,570,573,687,702,264,550,635,517,856,708,666,601,666,655,592,598,667,598,904,598,598,598,218,380,218,417,415,265,529,548,509,548,505,318,549,548,209,221,475,209,895,548,551,548,548,337,499,319,548,479,757,479,479,479,325,202,325,690,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,242,202,543,563,733,508,198,598,444,813,440,444,539,397,817,398,385,527,358,358,253,548,464,234,242,358,448,440,716,736,774,447,689,689,689,689,689,689,886,670,576,576,576,576,298,298,298,298,670,723,707,707,707,707,707,515,666,674,674,674,674,633,596,579,549,549,549,549,549,549,846,534,553,553,553,553,280,280,280,280,579,573,579,579,579,579,579,567,548,573,573,573,573,514,548,514,689,549,689,549,598,529,670,534,670,534,670,534,670,534,665,623,670,548,576,553,576,553,576,553,570,505,576,553,697,584,697,584,697,584,697,584,723,573,678,563,298,280,298,280,298,280,298,271,298,202,814,430,572,288,650,547,530,554,271,554,271,554,284,554,319,519,250,723,573,723,573,723,573,573,708,548,707,579,707,579,707,579,913,938,653,373,653,373,653,373,629,526,629,526,629,526,629,526,633,346,633,339,598,319,674,573,674,573,674,573,674,573,674,573,667,548,895,752,633,514,633,620,521,620,521,620,521,209,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,709,454,454,317,454,454,454,454,454,454,454,454,454,454,454,454,454,708,549,454,454,454,454,454,454,454,454,454,454,454,454,454,667,554,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,288,454,454,454,454,454,454,454,454,454,689,549,962,864,705,578,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,629,526,633,346,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,209,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,505,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,117,454,454,454,454,454,454,454,454,454,391,375,454,513,454,454,454,454,454,454,454,454,454,454,454,454,454,454,420,209,289,233,401,385,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,316,454,454,454,454,454,454,454,454,454,454,454,454,0,0,454,0,454,454,454,454,454,0,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,0,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,254,455,689,308,576,723,298,454,676,454,648,655,345,689,653,549,689,576,620,723,666,298,650,642,897,723,548,707,702,660,454,548,633,633,714,650,697,645,298,633,577,569,578,345,559,562,593,479,548,549,467,548,578,279,604,548,630,517,493,579,596,548,533,546,503,525,667,479,667,824,345,559,579,559,840,454,454,570,541,454,454,454,787,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,454,576,576,739,570,647,592,298,298,572,1037,1076,795,650,717,646,697,689,626,653,570,696,576,851,597,708,717,635,697,897,723,707,724,660,670,633,627,714,650,696,647,910,915,789,804,598,647,924,587,549,549,548,425,544,553,768,507,548,581,498,549,721,548,579,548,576,509,471,514,724,521,548,522,778,777,640,725,529,533,809,539,553,553,548,429,533,526,271,280,266,860,860,548,577,581,514,548,895,875,598,529,890,741,598,522,874,750,777,678,1032,876,514,488,744,762,666,564,603,485,658,522,1146,1031,666,548,889,829,895,875,617,513,597,0,0,0,0,454,0,0,670,529,598,529,626,563,549,432,549,425,548,494,874,754,631,526,637,530,598,520,645,485,796,631,665,529,1037,735,1013,834,745,586,670,534,633,521,633,522,598,479,606,468,839,638,612,503,647,549,647,573,737,588,775,612,298,1021,874,598,512,662,529,697,548,665,529,712,567,819,702,298,689,549,689,549,962,864,576,553,709,542,711,542,1021,874,631,526,570,570,717,581,717,581,707,579,704,578,704,578,666,532,646,514,646,514,646,514,712,567,570,429,804,725,570,429,606,468,598,479,527,577,739,855,787,642,532,500,963,802,949,823,616,511,705,636,647,569,663,530},
	
	__widget = nil,
	__pane = nil,
	__scrollOffset = 0,
	__messages = { length = 0 },
	__focusTextBox = true,
	__inputTextBox = nil,
	__nextMessageID = -1,
	__unread = 0,
	__ignoreScroll = 0,
	__commands = {['/'] = {}},
  __aliases = {}

}

function Chat.stringPixelWidth(str)

	local FONT_WIDTH = Chat.FONT_WIDTH	

	local Text = str:gsub('%^.-;', '')
	local width = 0

	for _, Code in utf8.codes(Text) do

		width = width + (FONT_WIDTH[Code] or 454)

	end

	return (width / 1000) * FONT_SIZE

end

function Chat.stringLineCount(str, maxWidth)

	local PixelWidth = Chat.stringPixelWidth
	local Floor = math.floor

	local lineCount = 0

	for Line in str:gmatch('[^\n]+') do

		lineCount = lineCount + 1

		local lineWidth = 0

		for Word in Line:gmatch('%S+') do

			local WordWidth = PixelWidth(Word)

			lineWidth = lineWidth + WordWidth

			--sb.logInfo('WORD: ' .. Word .. ' (' .. WordWidth .. ')')
			--sb.logInfo('WIDTH: ' .. lineWidth .. ' / ' .. maxWidth)

			-- New line time.
			if lineWidth > maxWidth then

				-- Wrap word across many lines.
				if WordWidth > maxWidth then

					local WordLines = math.floor(WordWidth / maxWidth)

					lineCount = lineCount + WordLines + 1
					lineWidth = WordWidth - (WordLines * maxWidth)

					--sb.logInfo('NEW LINE: ' .. lineCount .. ', ' .. lineWidth .. ' (' .. WordLines .. ')')

				else -- Put word on new line.

					lineCount = lineCount + 1
					lineWidth = WordWidth

					--sb.logInfo('NEW LINE: ' .. lineCount .. ', ' .. lineWidth)

				end

			end

			-- Space

			local SpaceWidth = PixelWidth(' ')

			lineWidth = lineWidth + SpaceWidth

			-- New line time.
			if lineWidth > maxWidth then

				-- Put word on new line.
				lineCount = lineCount + 1
				lineWidth = SpaceWidth

			end

		end

	end

	return lineCount

end

--[[
	
	Parameter Symbols:

	[param] - Optional
	[param=N] - Optional with default value.
	<param> - Required

	param: type - Typed
	--param - Optional Boolean

	Parameter Types:

	uint   - number from 0 to +infinity.
	int    - number from -infinity to +infinity.
	float  - int with decimals.
	bool   - true/false, on/off, enable/disable, yes/no.
	string - text, enclosable by quotes should spaces be present.
	json   - json syntax, transformed into a lua table.
	user   - string/uint that references a player in-game.

	Parameter Aliases:

	number -> float
	text   -> string

--]]

function Chat.addCommand(command, description, callback)

	local Commands = Chat.__commands
	local Command = {}
	local Parameters = {}

	local Start = command:find('%(') or (#command + 2)
	local Params = command:sub(Start)

	command = command:sub(1, Start - 2)

	--

	for Word in command:gmatch('([^%s]+)') do

		table.insert(Command, Word)

	end

	--

	for Name, Type, Optional in Params:gmatch('%((%w-): (%w-)(%??)%)') do

		table.insert(Parameters, {
			
			name = Name,
			type = Type,
			optional = Optional == '?'

		})

	end

	--

	local Count = #Command
	local list = Commands['/']
	local line = '/'

	for i = 1, Count - 1 do

		line = line .. Command[i] .. ' '
		Commands[line] = Commands[line] or {}
		list = Commands[line]

	end

	table.insert(list, {

		command = line .. Command[Count],
		description = description,
		parameters = Parameters,
		callback = callback,

	})

	table.sort(list, function(a, b) return a.command < a.command end)
	
	--

	Chat.update()

end

--------------

function Chat.formatText(message)

  local Aliases = Chat.__aliases;

	local R, G, B = 255, 255, 255

	return message:gsub('%^(.-);', function(color)

		if color == 'reset' then

			return '^reset;'

		end

		local H, S, L = 0, 0, 0
		local mod

	    -- Color Modifiers
	    color = Trim(color:upper())
			:gsub('RESET',  function() mod = nil;      return '' end)
			:gsub('HOT',    function() mod = 'hot';    return '' end)
			:gsub('NEON',   function() mod = 'neon';   return '' end)
			:gsub('PASTEL', function() mod = 'pastel'; return '' end)

			:gsub('WARM',  function() H = H - 0.0625; return '' end)
			:gsub('COOL',  function() H = H + 0.0625; return '' end)

			:gsub('PALE',  function() S = S - 0.2500; return '' end)
			:gsub('DEEP',  function() S = S + 0.2500; return '' end)

			:gsub('DARK',  function() L = L - 0.1250; return '' end)
			:gsub('LIGHT', function() L = L + 0.1250; return '' end)            

			:gsub(',', '')
			:gsub(' ', '_')

	    -- Base Color
		if color:sub(1, 1) == '#' then

			local Length = #color

			if Length == 4 then -- #RGB

				R = tonumber(color:sub(2, 2), 16) or R
				G = tonumber(color:sub(3, 3), 16) or G
				B = tonumber(color:sub(4, 4), 16) or B

			elseif Length == 7 then -- #RRGGBB

				R = tonumber(color:sub(2, 3), 16) or R
				G = tonumber(color:sub(4, 5), 16) or G
				B = tonumber(color:sub(6, 7), 16) or B

			elseif Length == 9 then -- #RRGGBBAA

				R = tonumber(color:sub(2, 3), 16) or R
				G = tonumber(color:sub(4, 5), 16) or G
				B = tonumber(color:sub(6, 7), 16) or B

			end

		else

			local Color = COLOR_CODES[color]

			if Color then

				R = Color[1]
				G = Color[2]
				B = Color[3]

			end

		end

		local H2, S2, L2 = rgbToHsl(R, G, B)

		if mod == 'hot' then

			S2 = 1.00
			L2 = 0.75

		elseif mod == 'neon' then

			S2 = 1.00
			L2 = 0.55

		elseif mod == 'pastel' then

			S2 = 0.85
			L2 = 0.85

		end

		H = (H + H2) % 1
		S = Clamp(S + S2, 0, 1)
		L = Clamp(L + L2, 0.25, 1)

		R, G, B = hslToRgb(H, S, L, 0)

		return
			'^#' ..
			string.format("%02X", R // 1) ..
			string.format("%02X", G // 1) ..
			string.format("%02X", B // 1) ..
			';'

	end)
    :gsub('{(.-)}', function(alias)

      return '{' .. (Aliases[alias:upper()] or alias) .. '}'
      
    end)
    :gsub('{{(.-)}}', function(alias)

      return '{{' .. (Aliases[alias:upper()] or alias) .. '}}'

    end)

end

function Chat.message(params)

	params = params or {}

	local GameTime = math.floor(world.timeOfDay() * WORLD_LENGTH) + TIMEZONE_OFFSET
	local Message = Chat.formatText(params.message or '')
	local MessageID = params.messageID or Chat.__nextMessageID

	Chat.__nextMessageID = Chat.__nextMessageID - 1

	return {
		avatar    = GetAvatar(params.avatar),       -- array: list of drawables
		discord   = params.discord,                 -- string?: author discord tag
		author    = Chat.formatText(params.author or ''), -- string: name of speaker
		message   = Message,                        -- string: message content
		authorID  = params.authorID  or -1,         -- number: unique author ID
		messageID = MessageID,                      -- number: unique message ID
		owner     = params.owner     or false,      -- bool: did the player send this
		realtime  = params.realtime  or os.time(),  -- number: time message was sent based on real time
		gametime  = params.gametime  or GameTime,   -- number: time message was sent based on in-game time
		lines     = Chat.stringLineCount(Message, 325 - (27*2)), -- number: amount of lines the message is composedof
		edited    = params.edited    or false       -- bool: has the message been edited
	}

end

function Chat.clientMessage(message)

	Chat.addMessage({
		--avatar = ???,
    avatar = {{ image = '/interface/newchat/AIicon.png', position = {2, 6} }},
		author = '^lightpaleneonocean;S.A.I.L',
		authorID = 2^32,
		message = message
	})

end

-- The following will be overrided.

function Chat.addMessage(message, dontFocus)

	local Messages = Chat.__messages

	Messages.length = Messages.length + 1

	for i = Messages.length, 2, -1 do

		Messages[i] = Messages[i - 1]

	end

	Messages[1] = Chat.message(message)

	if not dontFocus then

		Chat.focus()

	end

end

function Chat.focus(focus, text)

	if not Chat.__widget then

		player.interact('ScriptPane', '/interface/newchat/chat.config')

	end

end

function Chat.update()

end

-----------------------------------------------------------------------

local SECOND = 1;
local MINUTE = SECOND * 60;
local HOUR = MINUTE * 60;

function init()

	--
	local Messages = player.getProperty('VERGON_CHAT_MESSAGES', {length = 0})
	Chat.__aliases = player.getProperty('VERGON_CHAT_ALIASES', {});

	--
	local TimeNow = os.time()

	for i = Messages.length, 1, -1 do

		local Message = Messages[i..'']
		local Realtime = Message.realtime or 0

		if (TimeNow - Realtime) <= HOUR then

			Chat.addMessage(Message, true)

		end

	end

	--
	math.__chat = Chat

	-- Load client-side commands.
	require '/interface/newchat/commands.lua'

	--
	script.setUpdateDelta(1)

	--
	message.setHandler('CHAT_MESSAGE', function(_, _, message)

		Chat.addMessage(message)

		if Chat.__scrollOffset ~= 0 then

			Chat.__unread = Chat.__unread + 1
			Chat.__ignoreScroll = Chat.__ignoreScroll + 1

		end

		Chat.update()

	end)

	message.setHandler('UPDATE_MESSAGE', function(_, _, update)

		local Messages = Chat.__messages

		for i = 1, Messages.length do

			local Message = Messages[i]

			if Message.messageID == update.messageID then

				for Key, Value in pairs(update) do

					Message[Key] = Value

				end

				if update.realID then

					Message.messageID = Message.realID
					Message.realID = nil

				end

				if update.avatar then

					Message.avatar = GetAvatar(Message.avatar)

				end

				if update.author then

					Message.author = Chat.formatText(Message.author)

				end

				if update.message then

					Message.message = Chat.formatText(Message.message)
					Message.lines = Chat.stringLineCount(Message.message, 325 - (27*2))

				end

				if Message.owner and update.message and (not update.edited) and world.entityExists(MonsterID) then

					local line = Message.message

					if utf8.len(line) > 250 then

						local Offset = utf8.offset(line, 250-3)
						local Codepoints = {utf8.codepoint(line, 1, Offset)}

						line = utf8.char(table.unpack(Codepoints)) .. '...'

					end

					world.callScriptedEntity(MonsterID, 'monster.say', line)

				end

				Chat.update()
				break

			end

		end

	end)

	message.setHandler('DELETE_MESSAGE', function(_, _, mID)

		local Messages = Chat.__messages

		for i = 1, Messages.length do

			local Message = Messages[i]

			if Message.messageID == mID then

				table.remove(Messages, i)
				Messages.length = Messages.length - 1

				Chat.update()
				break

			end

		end

	end)

	message.setHandler('ADD_COMMANDS', function(_, _, list)

		for i = 1, #list do

			local Item = list[i]
			Chat.addCommand(Item.command, Item.description)

		end
		
	end)

end

-----------------------------------------------------------------------


function uninit()

	player.setProperty('VERGON_CHAT_ALIASES', Chat.__aliases);
	player.setProperty('VERGON_CHAT_MESSAGES', Chat.__messages)

end

-----------------------------------------------------------------------

function update()

	local Event = math.__event
	if not Event then return end

	--
	script.setUpdateDelta(0)

	Event.on('uninit', function()

		if Chat.__pane then

			Chat.__pane.dismiss()

		end

	end)

	Event.setInterval(function(deltaTime)

		-- Chat bubble.

		MonsterPosition[1] = mcontroller.xPosition()
		MonsterPosition[2] = mcontroller.yPosition() + 0.5

		if not MonsterID then

			local Config = root.assetJson('/monsters/monsterConfig.json')
			MonsterID = world.spawnMonster('mechshielddrone', MonsterPosition, Config)

		elseif world.entityExists(MonsterID) then

			world.callScriptedEntity(MonsterID, 'mcontroller.setPosition', MonsterPosition)

		else

			MonsterID = nil

		end

		-- /pingme notification sound.

		if (not math.__pingable) or (math.__pinged < 0) then

			return

		end

		math.__pinged = math.__pinged - deltaTime

		if math.__pinged <= 0 then

			if Chat.__pane then

				Chat.__pane.playSound('/sfx/objects/mechbeacon_pulse2.ogg', 3-1, 3)
				math.__pinged = 60

			else

				Chat.focus(false)
				math.__pinged = 0

			end

		end

	end)

end

-----------------------------------------------------------------------